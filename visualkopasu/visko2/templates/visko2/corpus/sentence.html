{% extends 'visko2/base.html' %}
{% load staticfiles %}

{% block content %}

<ol class="breadcrumb">
  <li class="breadcrumb-item"><a href="{% url 'visko2:list_collection' %}">Collection</a></li>
  <li class="breadcrumb-item"><a href="{% url 'visko2:list_corpus' collection_name=collection_name %}">{{ collection_name }}</a></li>
  <li class="breadcrumb-item"><a href="{% url 'visko2:list_doc' collection_name=collection_name corpus_name=corpus.name %}">{{ corpus.name }}</a></li>
  <li class="breadcrumb-item"><a href="{% url 'visko2:list_sent' collection_name=collection_name corpus_name=corpus.name doc_id=doc.ID %}">{{ doc.name }}</a></li>
</ol>

<h1 class="page-header">{{ sentence.text }}</h1>

Parse count: {{ sentence.interpretations|length }}

<ul class="nav nav-tabs">
  <li  class="active"><a data-toggle="tab" href="#delviz">Semantics</a></li>
  <li><a data-toggle="tab" href="#home">RAW</a></li>
</ul>
<div class="tab-content">
  <div id="delviz" class="tab-pane fade in active">
    <div id="dmrs_text_holder" class="dmrs_sentence_text"></div>
    <div id='viszone'></div>    
  </div>
  <div id="home" class="tab-pane fade">
    <code><pre>{% autoescape on %}{{ raw.parses.0.dmrs_str }}{% endautoescape %}</pre></code>
  </div>
</div>

{% endblock %}


{% block css %}
<style>
 .tab-pane {
   overflow: auto;
 }
</style>
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'viz/demo.css' %}"/>
<link rel="stylesheet" type="text/css" media="screen" href="{% static 'viz/delphin-viz.css' %}"/>
{% endblock %}


{% block script %}
<script type="text/javascript" src="{% static 'viz/lodash-4.11.2.min.js' %}"></script>
<script type="text/javascript" src="{% static 'viz/svg-2.3.0.min.js' %}"></script>
<script type="text/javascript" src="{% static 'viz/d3.v3.min.js' %}" charset="utf-8"></script>
<script type="text/javascript" src="{% static 'viz/demo.js' %}"></script>
<script type="text/javascript" src="{% static 'viz/tree.js' %}"></script>
<script type="text/javascript" src="{% static 'viz/mrs.js' %}"></script>
<script type="text/javascript" src="{% static 'viz/dmrs.js' %}"></script>

<script>
 function visualize(divid, text, dmrs_json, mrs_json){
   var vizdivtext = $('#dmrs_text_holder')      
   var $vizdiv = $('#' + divid);
   vizdivtext.text(text);
   $vizdiv.empty();
   var $viz = $(Templates.viz({vizType:'dmrs'})).appendTo($vizdiv);
   dmrs = DMRS($viz[0], dmrs_json);
   var $viz = $(Templates.viz({vizType:'mrs'})).appendTo($vizdiv);
   self.dmrs = MRS($viz[0], mrs_json, vizdivtext, '{{sentence_text}}');
 }
 
 $(document).ready(function(){
   {% autoescape off %}
   dmrs_json = {{isfsent.mrses.0.dmrs_json_str}};
   mrs_json = {{isfsent.mrses.0.mrs_json_str}};
   {% endautoescape %}
   visualize('viszone', '{% autoescape off %}{{ sentence.text }}{% endautoescape %}', dmrs_json, mrs_json);
 });
</script>
{% endblock %}
